# 企业级全栈 AI 应用 Monorepo 模板使用指南

> 📚 本指南将手把手教你如何使用这个模板创建、开发和部署一个完整的企业级全栈 AI 应用

## 📋 目录

- [第一步：环境准备](#第一步环境准备)
- [第二步：创建项目](#第二步创建项目)
- [第三步：初始化项目](#第三步初始化项目)
- [第四步：启动开发环境](#第四步启动开发环境)
- [第五步：开发工作流](#第五步开发工作流)
- [第六步：本地测试](#第六步本地测试)
- [第七步：部署到生产环境](#第七步部署到生产环境)
- [第八步：监控和维护](#第八步监控和维护)
- [常见问题](#常见问题)

---

## 第一步：环境准备

### 1.1 检查系统要求

确保你的系统满足以下要求：
- **操作系统**: Windows 10+, macOS 10.15+, 或 Linux
- **内存**: 至少 8GB RAM（推荐 16GB）
- **磁盘空间**: 至少 20GB 可用空间
- **网络**: 稳定的互联网连接

### 1.2 安装必要工具

#### 安装 Python 3.11.9

**macOS/Linux:**
```bash
# 使用 pyenv（推荐）
curl https://pyenv.run | bash
pyenv install 3.11.9
pyenv global 3.11.9

# 验证安装
python --version  # 应该显示 Python 3.11.9
```

**Windows:**
```powershell
# 下载并安装 Python 3.11.9
# 访问: https://www.python.org/downloads/release/python-3119/
# 或使用 Scoop
scoop install python@3.11.9

# 验证安装
python --version
```

#### 安装 Node.js 20.x

**macOS/Linux:**
```bash
# 使用 nvm（推荐）
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 20
nvm use 20

# 验证安装
node --version  # 应该显示 v20.x.x
```

**Windows:**
```powershell
# 使用 nvm-windows
# 下载: https://github.com/coreybutler/nvm-windows/releases
# 或使用 Scoop
scoop install nvm
nvm install 20
nvm use 20

# 验证安装
node --version
```

#### 安装 pnpm

```bash
# 使用 npm 安装
npm install -g pnpm

# 或使用 Homebrew (macOS)
brew install pnpm

# 验证安装
pnpm --version  # 应该显示 8.x 或更高
```

#### 安装 uv (Python 包管理器)

```bash
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -c "irm https://astral.sh/uv/install.ps1 | iex"

# 或使用 pip
pip install uv

# 验证安装
uv --version
```

#### 安装 Docker

**macOS:**
```bash
# 下载 Docker Desktop
# 访问: https://www.docker.com/products/docker-desktop/

# 或使用 Homebrew
brew install --cask docker
```

**Windows:**
```powershell
# 下载 Docker Desktop
# 访问: https://www.docker.com/products/docker-desktop/

# 或使用 Scoop
scoop install docker
```

**Linux (Ubuntu/Debian):**
```bash
# 安装 Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# 启动 Docker
sudo systemctl start docker
sudo systemctl enable docker

# 添加当前用户到 docker 组
sudo usermod -aG docker $USER

# 验证安装
docker --version
docker-compose --version
```

#### 安装 Just (可选，但推荐)

```bash
# macOS
brew install just

# Windows (Scoop)
scoop install just

# Linux
cargo install just

# 验证安装
just --version
```

#### 安装 Git

```bash
# macOS
brew install git

# Windows
scoop install git

# Ubuntu/Debian
sudo apt-get install git

# 验证安装
git --version
```

### 1.3 验证所有工具

运行以下命令确保所有工具都已正确安装：

```bash
# 检查版本
python --version    # Python 3.11.9
node --version      # v20.x.x
pnpm --version      # 8.x+
uv --version        # 0.x.x
docker --version    # 24.x+
git --version       # 2.x+
just --version      # 1.x+ (可选)
```

---

## 第二步：创建项目

### 2.1 安装 Cookiecutter

```bash
# 使用 pipx 安装（推荐，隔离环境）
pip install pipx
pipx install cookiecutter

# 或使用 pip 直接安装
pip install cookiecutter

# 验证安装
cookiecutter --version
```

### 2.2 从模板创建项目

#### 方式 1: 从 GitHub 创建（推荐）

```bash
# 创建项目目录
mkdir ~/projects
cd ~/projects

# 从 GitHub 仓库创建项目
cookiecutter gh:wanderer99176/code-template --directory py-starter-monorepo-ai
```

#### 方式 2: 从本地路径创建

```bash
# 如果已经克隆了模板仓库
cd ~/projects
cookiecutter /path/to/code-template/py-starter-monorepo-ai
```

### 2.3 填写项目信息

Cookiecutter 会提示你输入以下信息：

```bash
[1/22] project_name (My Enterprise AI App): 
# 输入: 我的AI应用平台

[2/22] project_slug (my-enterprise-ai-app): 
# 输入: my-ai-platform (会自动生成，可直接回车)

[3/22] package_name (my_enterprise_ai_app): 
# 输入: my_ai_platform (Python 包名，可直接回车)

[4/22] scraper_name (my_enterprise_ai_app_scraper): 
# 输入: my_ai_platform_scraper (可直接回车)

[5/22] author_name (Your Name): 
# 输入: 张三

[6/22] author_email (your.email@example.com): 
# 输入: zhangsan@example.com

[7/22] description (企业级全栈 AI 应用 Monorepo): 
# 输入: 智能数据分析平台 (或其他描述)

[8/22] version (0.1.0): 
# 输入: 直接回车使用默认值

[9/22] python_version (3.11.9): 
# 输入: 直接回车

[10/22] node_version (20.x): 
# 输入: 直接回车

[11/22] Select license:
  1 - MIT
  2 - Apache-2.0
  3 - BSD-3-Clause
  4 - GPL-3.0
Choose from [1/2/3/4] (1): 
# 输入: 1 (选择 MIT 许可证)

[12/22] database_name (my_enterprise_ai_app_db): 
# 输入: 直接回车

[13/22] database_user (my_enterprise_ai_app_user): 
# 输入: 直接回车

[14/22] github_username (your-github-username): 
# 输入: zhangsan (你的 GitHub 用户名)

[15/22] docker_registry (ghcr.io): 
# 输入: 直接回车 (或改为 docker.io)

[16/22] kubernetes_namespace (my-enterprise-ai-app): 
# 输入: 直接回车

[17/22] domain_name (example.com): 
# 输入: myaiplatform.com (你的域名)

[18/22] Select use_gpu:
  1 - yes
  2 - no
Choose from [1/2] (1): 
# 输入: 1 (如果需要 GPU) 或 2

[19/22] Select enable_monitoring:
  1 - yes
  2 - no
Choose from [1/2] (1): 
# 输入: 1 (推荐开启监控)

[20/22] Select enable_scraper:
  1 - yes
  2 - no
Choose from [1/2] (1): 
# 输入: 1 (如果需要爬虫) 或 2

[21/22] Select enable_ml_api:
  1 - yes
  2 - no
Choose from [1/2] (1): 
# 输入: 1 (如果需要机器学习 API) 或 2

[22/22] Select enable_audio_api:
  1 - yes
  2 - no
Choose from [1/2] (1): 
# 输入: 1 (如果需要语音识别 API) 或 2
```

### 2.4 验证项目创建

```bash
# 进入项目目录
cd my-ai-platform

# 查看项目结构
tree -L 2  # macOS/Linux
# 或
dir /s /b  # Windows

# 应该看到完整的项目结构
```

---

## 第三步：初始化项目

### 3.1 使用 Just 自动初始化（推荐）

```bash
# 进入项目目录
cd my-ai-platform

# 查看所有可用命令
just --list

# 运行初始化
just init
```

`just init` 会自动完成以下步骤：
1. ✅ 检查所有必需的工具（Python, Node.js, Docker 等）
2. ✅ 安装 pnpm 依赖
3. ✅ 为每个 Python 服务创建虚拟环境（使用 uv）
4. ✅ 安装 Python 依赖
5. ✅ 设置 pre-commit hooks
6. ✅ 创建环境变量文件（.env）
7. ✅ 启动 Docker Compose 基础服务
8. ✅ 运行数据库迁移

### 3.2 手动初始化（如果没有 Just）

#### 步骤 1: 安装 Node.js 依赖

```bash
# 安装所有 pnpm workspace 依赖
pnpm install
```

#### 步骤 2: 安装 Python 依赖

```bash
# Backend 服务
cd services/backend
uv venv
source .venv/bin/activate  # Linux/macOS
# 或
.venv\Scripts\activate  # Windows
uv pip install -e .
cd ../..

# ML API 服务（如果启用）
cd services/ml-api
uv venv
source .venv/bin/activate
uv pip install -e .
cd ../..

# Audio API 服务（如果启用）
cd services/audio-api
uv venv
source .venv/bin/activate
uv pip install -e .
cd ../..

# Scraper 服务（如果启用）
cd services/scraper
uv venv
source .venv/bin/activate
uv pip install -e .
cd ../..
```

#### 步骤 3: 配置环境变量

```bash
# 创建 .env 文件
cp .env.example .env  # 如果有示例文件

# 或手动创建
cat > .env << 'EOF'
# 数据库配置
DATABASE_URL=postgresql://my_ai_platform_user:changeme@localhost:5432/my_ai_platform_db

# Redis 配置
REDIS_URL=redis://localhost:6379/0

# JWT 配置
SECRET_KEY=your-super-secret-key-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30

# 应用配置
ENVIRONMENT=development
LOG_LEVEL=DEBUG
CORS_ORIGINS=http://localhost:3000

# MinIO (S3 兼容)
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin
MINIO_ENDPOINT=localhost:9000

# 监控配置（可选）
PROMETHEUS_ENABLED=true
JAEGER_ENABLED=true
EOF
```

#### 步骤 4: 设置 Pre-commit Hooks

```bash
# 安装 pre-commit
pip install pre-commit

# 安装 git hooks
pre-commit install

# 测试 hooks（可选）
pre-commit run --all-files
```

#### 步骤 5: 启动基础设施服务

```bash
# 启动 PostgreSQL、Redis、MinIO
docker-compose -f infra/docker-compose/dev.yml up -d

# 等待服务启动（约 10-20 秒）
sleep 20

# 验证服务状态
docker-compose -f infra/docker-compose/dev.yml ps
```

#### 步骤 6: 运行数据库迁移

```bash
# 进入 backend 目录
cd services/backend

# 激活虚拟环境
source .venv/bin/activate  # Linux/macOS
# 或
.venv\Scripts\activate  # Windows

# 运行迁移
alembic upgrade head

# 返回根目录
cd ../..
```

---

## 第四步：启动开发环境

### 4.1 使用 Just 启动（推荐）

```bash
# 启动所有开发服务
just dev

# 这会自动启动：
# - Backend API (http://localhost:8000)
# - Frontend (http://localhost:3000)
# - ML API (http://localhost:8001) - 如果启用
# - Audio API (http://localhost:8002) - 如果启用
```

### 4.2 手动启动各个服务

#### 启动 Backend

```bash
# 新开一个终端
cd services/backend
source .venv/bin/activate
uvicorn my_ai_platform.main:app --reload --host 0.0.0.0 --port 8000
```

#### 启动 Frontend

```bash
# 新开一个终端
cd services/frontend
pnpm dev
```

#### 启动 ML API（如果启用）

```bash
# 新开一个终端
cd services/ml-api
source .venv/bin/activate
uvicorn main:app --reload --host 0.0.0.0 --port 8001
```

#### 启动 Audio API（如果启用）

```bash
# 新开一个终端
cd services/audio-api
source .venv/bin/activate
uvicorn main:app --reload --host 0.0.0.0 --port 8002
```

### 4.3 验证服务运行

访问以下 URL 验证服务：

- **Frontend**: http://localhost:3000
- **Backend API Docs**: http://localhost:8000/docs
- **Backend Health**: http://localhost:8000/health/live
- **ML API Docs**: http://localhost:8001/docs (如果启用)
- **Audio API Docs**: http://localhost:8002/docs (如果启用)

### 4.4 启动监控服务（可选）

```bash
# 使用 Just
just monitoring-up

# 或使用 Docker Compose
docker-compose -f infra/docker-compose/monitoring.yml up -d

# 访问监控面板
# Grafana: http://localhost:3001 (admin/admin)
# Prometheus: http://localhost:9090
# Jaeger: http://localhost:16686
```

---

## 第五步：开发工作流

### 5.1 添加新的 API 端点

#### 步骤 1: 创建端点文件

```bash
# 在 backend 中创建新端点
cd services/backend/src/my_ai_platform/api/v1/endpoints

# 创建新端点文件
cat > products.py << 'EOF'
"""
产品管理端点
"""
from fastapi import APIRouter, Depends, HTTPException
from typing import List

router = APIRouter()

@router.get("/products")
async def get_products():
    """获取所有产品"""
    return {"products": []}

@router.get("/products/{product_id}")
async def get_product(product_id: int):
    """获取单个产品"""
    return {"id": product_id, "name": "示例产品"}

@router.post("/products")
async def create_product(product: dict):
    """创建新产品"""
    return {"id": 1, **product}
EOF
```

#### 步骤 2: 注册路由

```bash
# 编辑 router.py
cd services/backend/src/my_ai_platform/api/v1

# 在 router.py 中添加
```

```python
# api/v1/router.py
from fastapi import APIRouter
from .endpoints import auth, users, health, products  # 添加 products

api_router = APIRouter()

api_router.include_router(auth.router, prefix="/auth", tags=["认证"])
api_router.include_router(users.router, prefix="/users", tags=["用户"])
api_router.include_router(health.router, prefix="/health", tags=["健康检查"])
api_router.include_router(products.router, prefix="/products", tags=["产品"])  # 新增
```

#### 步骤 3: 生成 TypeScript 类型

```bash
# 返回项目根目录
cd ~/projects/my-ai-platform

# 生成类型定义
just codegen

# 或使用 pnpm
pnpm codegen
```

#### 步骤 4: 在 Frontend 使用新 API

```vue
<!-- services/frontend/pages/products.vue -->
<script setup lang="ts">
import type { Product } from '@my-ai-platform/shared-types'

const { data: products } = await useFetch<Product[]>('/api/products')
</script>

<template>
  <div>
    <h1>产品列表</h1>
    <ul>
      <li v-for="product in products" :key="product.id">
        {{ product.name }}
      </li>
    </ul>
  </div>
</template>
```

### 5.2 添加数据库模型

#### 步骤 1: 创建模型

```python
# services/backend/src/my_ai_platform/db/models.py
from sqlmodel import SQLModel, Field
from typing import Optional
from datetime import datetime

class Product(SQLModel, table=True):
    """产品模型"""
    id: Optional[int] = Field(default=None, primary_key=True)
    name: str = Field(index=True)
    description: str
    price: float
    created_at: datetime = Field(default_factory=datetime.utcnow)
    updated_at: datetime = Field(default_factory=datetime.utcnow)
```

#### 步骤 2: 创建迁移

```bash
# 使用 Just
just db-migrate name="add_product_table"

# 或手动
cd services/backend
source .venv/bin/activate
alembic revision --autogenerate -m "add_product_table"
```

#### 步骤 3: 应用迁移

```bash
# 使用 Just
just db-upgrade

# 或手动
cd services/backend
source .venv/bin/activate
alembic upgrade head
```

### 5.3 代码质量检查

```bash
# 运行所有检查
just lint          # Linting 检查
just typecheck     # 类型检查
just format        # 代码格式化

# 自动修复问题
just lint-fix

# 模拟 CI 流程（推荐在提交前运行）
just ci
```

---

## 第六步：本地测试

### 6.1 运行单元测试

```bash
# 使用 Just 运行所有测试
just test

# 运行特定服务的测试
cd services/backend
source .venv/bin/activate
pytest

# 运行前端测试
cd services/frontend
pnpm test
```

### 6.2 运行测试并生成覆盖率报告

```bash
# 使用 Just
just test-cov

# 查看覆盖率报告
# Backend: services/backend/htmlcov/index.html
# Frontend: services/frontend/coverage/index.html
```

### 6.3 E2E 测试（如果配置）

```bash
# 确保所有服务都在运行
just dev

# 在新终端运行 E2E 测试
pnpm test:e2e
```

---

## 第七步：部署到生产环境

### 7.1 本地 Docker 部署

#### 步骤 1: 构建 Docker 镜像

```bash
# 使用 Just
just docker-build

# 或使用 Docker Compose
docker-compose build
```

#### 步骤 2: 启动应用栈

```bash
# 启动完整应用栈
docker-compose up -d

# 查看日志
docker-compose logs -f

# 查看服务状态
docker-compose ps
```

#### 步骤 3: 访问应用

- Frontend: http://localhost:3000
- Backend: http://localhost:8000

### 7.2 部署到 Kubernetes

#### 步骤 1: 准备 Kubernetes 集群

**本地测试（使用 Minikube）：**
```bash
# 安装 Minikube
brew install minikube  # macOS
# 或
choco install minikube  # Windows

# 启动集群
minikube start --cpus=4 --memory=8192

# 验证集群
kubectl cluster-info
```

**或使用云平台的 Kubernetes（见步骤 7.3）**

#### 步骤 2: 部署核心基础设施

```bash
# 使用 Just
just k8s-apply

# 或手动部署
kubectl apply -f infra/kubernetes/core-infra/

# 验证部署
kubectl get all -n my-ai-platform
```

#### 步骤 3: 部署应用服务

```bash
# 使用 Just
just k8s-deploy

# 或使用 Helm
helm install backend ./infra/kubernetes/helm-charts/backend \
  --namespace my-ai-platform

helm install frontend ./infra/kubernetes/helm-charts/frontend \
  --namespace my-ai-platform
```

#### 步骤 4: 验证部署

```bash
# 查看 Pods 状态
kubectl get pods -n my-ai-platform

# 查看服务
kubectl get svc -n my-ai-platform

# 查看 Ingress
kubectl get ingress -n my-ai-platform

# 查看日志
kubectl logs -f deployment/backend -n my-ai-platform
```

#### 步骤 5: 访问应用

**使用 Minikube:**
```bash
# 获取服务 URL
minikube service frontend -n my-ai-platform --url

# 或使用端口转发
kubectl port-forward -n my-ai-platform svc/frontend 3000:3000
kubectl port-forward -n my-ai-platform svc/backend 8000:8000
```

### 7.3 部署到 AWS（使用 Terraform）

#### 步骤 1: 配置 AWS 凭证

```bash
# 安装 AWS CLI
brew install awscli  # macOS
# 或
pip install awscli

# 配置凭证
aws configure
# AWS Access Key ID: <your-access-key>
# AWS Secret Access Key: <your-secret-key>
# Default region: us-west-2
# Default output format: json
```

#### 步骤 2: 创建 S3 后端（首次部署）

```bash
# 创建 Terraform 状态存储桶
aws s3 mb s3://my-ai-platform-terraform-state --region us-west-2

# 创建 DynamoDB 锁表
aws dynamodb create-table \
  --table-name my-ai-platform-terraform-locks \
  --attribute-definitions AttributeName=LockID,AttributeType=S \
  --key-schema AttributeName=LockID,KeyType=HASH \
  --billing-mode PAY_PER_REQUEST \
  --region us-west-2
```

#### 步骤 3: 初始化 Terraform

```bash
# 进入 Terraform 目录
cd infra/tofu

# 初始化（使用 Just）
just tf-init

# 或手动
tofu init
```

#### 步骤 4: 查看执行计划

```bash
# 使用 Just
just tf-plan

# 或手动
tofu plan

# 保存计划到文件
tofu plan -out=tfplan
```

#### 步骤 5: 应用变更（创建基础设施）

```bash
# 使用 Just
just tf-apply

# 或手动
tofu apply

# 应用已保存的计划
tofu apply tfplan
```

**预计创建时间**: 15-20 分钟

**创建的资源**:
- VPC 网络（子网、路由表、NAT Gateway）
- EKS Kubernetes 集群
- RDS PostgreSQL 数据库（Multi-AZ）
- ElastiCache Redis 集群
- S3 存储桶
- IAM 角色和策略

#### 步骤 6: 配置 kubectl

```bash
# 获取 EKS 凭证
aws eks update-kubeconfig --region us-west-2 --name my-ai-platform-cluster

# 验证连接
kubectl get nodes

# 查看集群信息
kubectl cluster-info
```

#### 步骤 7: 部署应用到 EKS

```bash
# 部署核心基础设施
kubectl apply -f infra/kubernetes/core-infra/

# 部署应用服务
helm install backend ./infra/kubernetes/helm-charts/backend
helm install frontend ./infra/kubernetes/helm-charts/frontend

# 或使用 Just
just k8s-apply
just k8s-deploy
```

#### 步骤 8: 获取应用访问地址

```bash
# 获取 Ingress 地址
kubectl get ingress -n my-ai-platform

# 输出示例:
# NAME       CLASS    HOSTS                    ADDRESS                                    
# backend    traefik  api.myaiplatform.com    a1234567890.us-west-2.elb.amazonaws.com
# frontend   traefik  myaiplatform.com        a1234567890.us-west-2.elb.amazonaws.com

# 配置 DNS
# 将 myaiplatform.com 和 api.myaiplatform.com 的 CNAME 记录指向 ELB 地址
```

#### 步骤 9: 验证部署

```bash
# 检查所有资源
kubectl get all -n my-ai-platform

# 查看应用日志
kubectl logs -f deployment/backend -n my-ai-platform

# 访问应用
# https://myaiplatform.com
# https://api.myaiplatform.com/docs
```

---

## 第八步：监控和维护

### 8.1 查看应用日志

```bash
# 使用 Just
just logs backend

# 或使用 kubectl
kubectl logs -f deployment/backend -n my-ai-platform

# 查看最近 100 行
kubectl logs --tail=100 deployment/backend -n my-ai-platform

# 查看所有容器日志
kubectl logs -f deployment/backend -n my-ai-platform --all-containers
```

### 8.2 访问监控面板

**Grafana（可视化）:**
- URL: http://localhost:3001 (本地) 或 https://grafana.myaiplatform.com
- 默认登录: admin / admin
- 查看预配置的仪表板

**Prometheus（指标）:**
- URL: http://localhost:9090 (本地)
- 查询应用指标

**Jaeger（追踪）:**
- URL: http://localhost:16686 (本地)
- 查看分布式追踪信息

### 8.3 数据库备份

```bash
# 使用 Just（自动备份到 S3）
just db-backup

# 或手动备份
docker-compose exec postgres pg_dump -U my_ai_platform_user my_ai_platform_db > backup.sql

# 恢复备份
docker-compose exec -T postgres psql -U my_ai_platform_user my_ai_platform_db < backup.sql
```

### 8.4 更新应用

```bash
# 1. 拉取最新代码
git pull origin main

# 2. 安装新依赖
pnpm install
cd services/backend && uv pip install -e . && cd ../..

# 3. 运行迁移
just db-upgrade

# 4. 重新构建镜像
just docker-build

# 5. 更新 Kubernetes 部署
kubectl rollout restart deployment/backend -n my-ai-platform
kubectl rollout restart deployment/frontend -n my-ai-platform

# 6. 查看更新状态
kubectl rollout status deployment/backend -n my-ai-platform
```

### 8.5 扩缩容

```bash
# 手动扩容
kubectl scale deployment/backend --replicas=5 -n my-ai-platform

# 查看 HPA 自动扩缩容状态
kubectl get hpa -n my-ai-platform

# 调整 HPA 配置
kubectl edit hpa backend-hpa -n my-ai-platform
```

### 8.6 性能优化

#### 查看资源使用

```bash
# 查看 Pod 资源使用
kubectl top pods -n my-ai-platform

# 查看节点资源使用
kubectl top nodes
```

#### 优化建议

1. **数据库优化**:
   - 添加索引
   - 使用连接池
   - 启用查询缓存

2. **缓存优化**:
   - 使用 Redis 缓存热数据
   - 配置合适的过期时间
   - 使用缓存预热

3. **前端优化**:
   - 启用 SSR/SSG
   - 配置 CDN
   - 压缩静态资源

---

## 常见问题

### Q1: 端口被占用怎么办？

```bash
# 查找占用端口的进程
# macOS/Linux
lsof -i :3000
lsof -i :8000

# Windows
netstat -ano | findstr :3000

# 杀死进程
kill -9 <PID>  # macOS/Linux
taskkill /PID <PID> /F  # Windows
```

### Q2: Docker 服务启动失败？

```bash
# 查看详细日志
docker-compose logs -f <service-name>

# 重新启动服务
docker-compose restart <service-name>

# 清理并重建
docker-compose down -v
docker-compose up -d --build
```

### Q3: 数据库迁移失败？

```bash
# 查看迁移历史
cd services/backend
source .venv/bin/activate
alembic history

# 回滚到上一个版本
alembic downgrade -1

# 重新运行迁移
alembic upgrade head

# 如果出现冲突，手动修复迁移文件
```

### Q4: 类型生成失败？

```bash
# 确保后端服务运行
curl http://localhost:8000/openapi.json

# 手动生成类型
cd packages/shared-types
pnpm run codegen

# 检查生成的文件
cat index.ts
```

### Q5: Kubernetes 部署失败？

```bash
# 查看 Pod 事件
kubectl describe pod <pod-name> -n my-ai-platform

# 查看 Pod 日志
kubectl logs <pod-name> -n my-ai-platform

# 检查配置
kubectl get configmap -n my-ai-platform
kubectl get secret -n my-ai-platform

# 重新部署
kubectl delete pod <pod-name> -n my-ai-platform
```

### Q6: 如何清理所有资源？

```bash
# 停止本地开发环境
just dev-down

# 停止 Docker 服务
docker-compose down -v
docker-compose -f infra/docker-compose/monitoring.yml down -v

# 删除 Kubernetes 资源
helm uninstall backend frontend -n my-ai-platform
kubectl delete namespace my-ai-platform

# 销毁 AWS 基础设施（⚠️ 谨慎操作）
cd infra/tofu
just tf-destroy
# 或
tofu destroy
```

### Q7: 如何查看所有可用命令？

```bash
# 查看 Just 命令
just --list

# 查看 Make 命令
make help

# 查看 pnpm 脚本
pnpm run
```

---

## 📚 进一步学习

### 推荐资源

1. **官方文档**:
   - [FastAPI 文档](https://fastapi.tiangolo.com/)
   - [Nuxt 3 文档](https://nuxt.com/)
   - [Kubernetes 文档](https://kubernetes.io/docs/)
   - [Terraform 文档](https://www.terraform.io/docs/)

2. **项目文档**:
   - [环境搭建指南]({{ cookiecutter.project_slug }}/docs/setup-guide.md)
   - [部署手册]({{ cookiecutter.project_slug }}/docs/deployment.md)
   - [架构决策]({{ cookiecutter.project_slug }}/docs/adr/)

3. **最佳实践**:
   - [Monorepo 最佳实践](https://monorepo.tools/)
   - [12-Factor App](https://12factor.net/)
   - [Kubernetes 最佳实践](https://kubernetes.io/docs/concepts/configuration/overview/)

---

## 🎉 下一步

恭喜！你已经成功创建并部署了一个企业级全栈 AI 应用。接下来你可以：

1. 🔧 **定制功能**: 根据业务需求添加新的 API 端点和页面
2. 🎨 **优化 UI**: 使用 UI Kit 组件库美化前端界面
3. 🤖 **集成 AI**: 利用 ML API 和 Audio API 构建智能功能
4. 📊 **配置监控**: 设置 Grafana 告警和自定义仪表板
5. 🚀 **持续优化**: 根据监控数据优化性能和成本

**祝开发愉快！** 🚀

如有问题，请查看项目文档或提交 Issue。

