# 项目结构说明

本文档详细说明了 {{ cookiecutter.project_name }} 的项目结构。

## 📁 完整目录结构

```
{{ cookiecutter.project_slug }}/
├── .github/                    # GitHub 配置
│   ├── workflows/              # GitHub Actions 工作流
│   │   ├── ci-cd.yml          # CI/CD 流水线
│   │   └── dependabot.yml     # 依赖自动更新
│   ├── ISSUE_TEMPLATE/        # Issue 模板
│   │   ├── bug_report.md
│   │   └── feature_request.md
│   └── pull_request_template.md
│
├── docs/                       # 项目文档
│   ├── adr/                   # 架构决策记录 (Architecture Decision Records)
│   │   ├── 001-monorepo-architecture.md
│   │   └── README.md
│   ├── setup-guide.md         # 环境搭建指南
│   └── deployment.md          # 部署手册
│
├── infra/                     # 基础设施配置
│   ├── docker-compose/        # Docker Compose 配置
│   │   ├── dev.yml           # 开发环境
│   │   ├── monitoring.yml    # 监控套件 (Prometheus, Grafana, Loki, Jaeger)
│   │   ├── prometheus/
│   │   │   └── prometheus.yml
│   │   ├── loki/
│   │   │   └── local-config.yaml
│   │   └── promtail/
│   │       └── config.yml
│   │
│   ├── kubernetes/            # Kubernetes 配置
│   │   ├── helm-charts/      # Helm Charts
│   │   │   ├── backend/      # 后端服务 Helm Chart
│   │   │   │   ├── Chart.yaml
│   │   │   │   ├── values.yaml
│   │   │   │   └── templates/
│   │   │   │       ├── _helpers.tpl
│   │   │   │       ├── deployment.yaml
│   │   │   │       ├── service.yaml
│   │   │   │       ├── ingress.yaml
│   │   │   │       └── hpa.yaml
│   │   │   └── frontend/     # 前端服务 Helm Chart
│   │   │       ├── Chart.yaml
│   │   │       ├── values.yaml
│   │   │       └── templates/
│   │   └── core-infra/       # 核心基础设施
│   │       ├── namespace.yaml
│   │       ├── postgres.yaml
│   │       ├── redis.yaml
│   │       ├── secrets.yaml
│   │       ├── configmap.yaml
│   │       ├── cert-manager.yaml
│   │       └── network-policies.yaml
│   │
│   └── tofu/                  # OpenTofu (Terraform) IaC
│       ├── main.tf           # 主配置
│       ├── variables.tf      # 变量定义
│       ├── outputs.tf        # 输出值
│       ├── vpc.tf            # VPC 网络
│       ├── eks.tf            # EKS 集群
│       ├── rds.tf            # RDS 数据库
│       ├── elasticache.tf    # ElastiCache Redis
│       ├── s3.tf             # S3 存储
│       └── README.md         # Terraform 使用指南
│
├── packages/                  # 共享包 (Monorepo 共享代码)
│   ├── shared-types/         # TypeScript 类型定义
│   │   ├── index.ts
│   │   ├── package.json
│   │   ├── tsconfig.json
│   │   └── README.md
│   │
│   ├── ui-kit/               # UI 组件库
│   │   ├── src/
│   │   │   ├── components/
│   │   │   │   ├── Button.vue
│   │   │   │   └── Card.vue
│   │   │   ├── utils/
│   │   │   │   ├── colors.ts
│   │   │   │   └── formatters.ts
│   │   │   └── index.ts
│   │   ├── package.json
│   │   ├── tsconfig.json
│   │   └── README.md
│   │
│   ├── eslint-config-custom/ # 共享 ESLint 配置
│   │   ├── index.js
│   │   └── package.json
│   │
│   └── tsconfig-custom/      # 共享 TypeScript 配置
│       ├── base.json
│       └── package.json
│
├── scripts/                   # 项目脚本
│   ├── setup.sh              # 自动化环境设置
│   ├── codegen.sh            # OpenAPI → TypeScript 类型生成
│   └── db-backup.sh          # 数据库备份脚本
│
├── services/                  # 所有微服务
│   ├── backend/              # FastAPI 后端 API
│   │   ├── src/
│   │   │   └── {{ cookiecutter.package_name }}/
│   │   │       ├── __init__.py
│   │   │       ├── main.py
│   │   │       ├── api/
│   │   │       │   └── v1/
│   │   │       │       ├── router.py
│   │   │       │       └── endpoints/
│   │   │       │           ├── auth.py
│   │   │       │           ├── users.py
│   │   │       │           └── health.py
│   │   │       ├── core/
│   │   │       │   ├── config.py
│   │   │       │   └── logging.py
│   │   │       └── db/
│   │   │           ├── base.py
│   │   │           └── session.py
│   │   ├── Dockerfile
│   │   ├── pyproject.toml
│   │   └── README.md
│   │
│   ├── frontend/             # Nuxt.js 前端应用
│   │   ├── pages/
│   │   │   └── index.vue
│   │   ├── app.vue
│   │   ├── nuxt.config.ts
│   │   ├── Dockerfile
│   │   ├── package.json
│   │   └── README.md
│   │
│   ├── ml-api/               # YOLOv8 机器学习 API
│   │   ├── src/
│   │   │   └── main.py
│   │   └── pyproject.toml
│   │
│   ├── audio-api/            # Whisper 语音识别 API
│   │   ├── src/
│   │   │   └── main.py
│   │   └── pyproject.toml
│   │
│   └── scraper/              # Scrapy 爬虫服务
│       ├── {{ cookiecutter.scraper_name }}/
│       │   ├── spiders/
│       │   │   └── example_spider.py
│       │   └── settings.py
│       ├── scrapy.cfg
│       └── README.md
│
├── data/                      # 数据目录
│   ├── raw/                  # 原始数据
│   │   └── .gitkeep
│   └── processed/            # 处理后的数据
│       └── .gitkeep
│
├── .gitignore                # Git 忽略文件
├── .dockerignore             # Docker 忽略文件
├── .pre-commit-config.yaml   # Pre-commit hooks 配置
├── .prettierrc               # Prettier 配置
├── .editorconfig             # EditorConfig 配置
├── docker-compose.yml        # Docker Compose 主配置
├── package.json              # 根 package.json (pnpm workspace)
├── pnpm-workspace.yaml       # pnpm workspace 配置
├── pyproject.toml            # 根 Python 项目配置
├── tsconfig.base.json        # 基础 TypeScript 配置
├── turbo.json                # Turborepo 构建配置
├── justfile                  # Just 任务运行器
├── Makefile                  # Make 任务运行器
├── CHANGELOG.md              # 变更日志
├── CONTRIBUTING.md           # 贡献指南
├── LICENSE                   # 许可证
└── README.md                 # 项目主文档
```

## 🏗️ 架构分层

### 1. 前端层 (Frontend)
- **技术栈**: Nuxt 3 + Vue 3 + TypeScript
- **位置**: `services/frontend/`
- **职责**: 用户界面、交互逻辑、状态管理

### 2. API 网关层 (Backend)
- **技术栈**: FastAPI + Python {{ cookiecutter.python_version }}
- **位置**: `services/backend/`
- **职责**: 
  - RESTful API
  - 认证授权 (JWT)
  - 业务逻辑
  - 数据库操作

### 3. AI 服务层
#### ML API (机器学习)
- **技术栈**: FastAPI + YOLOv8
- **位置**: `services/ml-api/`
- **职责**: 图像识别、物体检测

#### Audio API (语音识别)
- **技术栈**: FastAPI + Whisper
- **位置**: `services/audio-api/`
- **职责**: 语音转文字、音频处理

### 4. 数据采集层
- **技术栈**: Scrapy
- **位置**: `services/scraper/`
- **职责**: 网页爬取、数据采集

### 5. 共享层 (Packages)
- **shared-types**: 共享 TypeScript 类型
- **ui-kit**: 共享 UI 组件
- **eslint-config-custom**: 共享 Linting 配置
- **tsconfig-custom**: 共享 TypeScript 配置

## 🔧 基础设施

### Docker Compose
- **开发环境** (`infra/docker-compose/dev.yml`):
  - PostgreSQL
  - Redis
  - Mailhog (邮件测试)

- **监控环境** (`infra/docker-compose/monitoring.yml`):
  - Prometheus (指标收集)
  - Grafana (可视化)
  - Loki (日志聚合)
  - Promtail (日志采集)
  - Jaeger (分布式追踪)

### Kubernetes
- **Helm Charts**: 微服务部署配置
- **Core Infrastructure**: 数据库、缓存、密钥等核心服务

### OpenTofu/Terraform
完整的 AWS 基础设施代码，包括:
- VPC 网络
- EKS Kubernetes 集群
- RDS PostgreSQL 数据库
- ElastiCache Redis
- S3 存储桶
- IAM 角色和策略

## 📦 依赖管理

### Python
- **工具**: `uv` (快速 Python 包管理器)
- **配置**: `pyproject.toml`
- **虚拟环境**: 每个服务独立的 `.venv`

### JavaScript/TypeScript
- **工具**: `pnpm` (快速、节省磁盘空间)
- **配置**: `package.json` + `pnpm-workspace.yaml`
- **构建**: `Turborepo` (增量构建)

## 🚀 快速开始

### 1. 初始化项目
```bash
just init
# 或
make init
```

### 2. 启动开发环境
```bash
just dev
# 或
make dev
```

### 3. 查看所有可用命令
```bash
just --list
# 或
make help
```

## 📚 更多文档

- [环境搭建指南](docs/setup-guide.md)
- [部署手册](docs/deployment.md)
- [架构决策记录](docs/adr/README.md)
- [贡献指南](CONTRIBUTING.md)
- [变更日志](CHANGELOG.md)

## 🔗 相关资源

- [FastAPI 文档](https://fastapi.tiangolo.com/)
- [Nuxt 3 文档](https://nuxt.com/)
- [Kubernetes 文档](https://kubernetes.io/docs/)
- [OpenTofu 文档](https://opentofu.org/docs/)
- [pnpm 文档](https://pnpm.io/)
- [uv 文档](https://github.com/astral-sh/uv)

