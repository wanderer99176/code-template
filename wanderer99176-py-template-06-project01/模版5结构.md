终极版：企业级全栈 AI 应用 Monorepo 完整蓝图
{{ cookiecutter.project_slug }}/
├──.github/
│   ├── ISSUE_TEMPLATE/               # 问题报告和功能请求的模板
│   │   ├── bug_report.md
│   │   └── feature_request.md
│   └── workflows/
│       ├── ci-cd.yml                 # 核心 CI/CD 流水线 (测试, Lint, Trivy 扫描, 构建 Docker 镜像, 推送到镜像仓库, 触发 Helm 部署)
│       └── dependabot.yml            # GitHub Dependabot 配置, 自动化依赖更新
│
├── docs/                             # 项目文档
│   ├── adr/                          # 架构决策记录 (Architecture Decision Records)
│   │   └── 001-monorepo-architecture.md
│   ├── setup-guide.md                # 新成员环境搭建指南
│   └── deployment.md                 # 生产环境部署手册
│
├── infra/                          # 基础设施即代码 (IaC) 与环境配置
│   ├── docker-compose/
│   │   ├── dev.yml                 # 本地开发核心服务 (PostgreSQL, Redis, MinIO)
│   │   └── monitoring.yml          # 本地可观测性套件 (Prometheus, Grafana, Loki, Jaeger)
│   ├── kubernetes/
│   │   ├── helm-charts/            # 所有服务的 Helm Charts, 用于生产部署
│   │   │   ├── backend/
│   │   │   ├── frontend/
│   │   │   ├── ml-api/
│   │   │   ├── audio-api/
│   │   │   └── scraper/
│   │   └── core-infra/             # K8s 集群核心基础设施 (Traefik Ingress, cert-manager, Prometheus Operator)
│   └── tofu/                       # OpenTofu 配置
│       ├── modules/                # 可复用的基础设施模块 (如 S3, RDS)
│       ├── environments/
│       │   ├── staging/            # 预发布环境
│       │   └── production/         # 生产环境
│       └── main.tf                 # 主配置文件
│
├── packages/                       # 跨服务共享的代码包 (JS/TS 生态)
│   ├── shared-types/               # [核心] 自动生成的、前后端共享的 TypeScript 类型
│   │   ├── openapi.json            # 从 FastAPI 自动生成的 OpenAPI 规范
│   │   ├── index.ts                # 生成的 TS 类型入口
│   │   ├── package.json
│   │   └── tsconfig.json
│   ├── ui-kit/                     # 共享的 Nuxt UI 组件库 (基于 Nuxt UI)
│   │   ├── components/
│   │   ├── package.json
│   │   └── tsconfig.json
│   ├── eslint-config-custom/       # 共享的 ESLint 配置
│   └── tsconfig-custom/            # 共享的 TypeScript 基础配置
│
├── scripts/                        # 项目级别的辅助脚本
│   ├── codegen.sh                  # 一键生成 shared-types 的脚本
│   ├── db-backup.sh                # 数据库备份脚本
│   └── setup.sh                    # 自动化项目初始化脚本
│
├── services/                       # 所有可独立部署的应用/微服务
│   ├── backend/                    # [核心] 业务逻辑 API (FastAPI)
│   │   ├── alembic/                # Alembic 数据库迁移脚本
│   │   │   ├── versions/
│   │   │   └── env.py
│   │   ├── src/{{ cookiecutter.package_name }}/
│   │   │   ├── api/                # API 层: 路由、依赖注入
│   │   │   │   ├── deps.py
│   │   │   │   └── v1/             # API 版本控制
│   │   │   │       └── endpoints/  # 按功能组织的路由文件
│   │   │   ├── core/
│   │   │   │   ├── config.py     # Pydantic Settings 管理环境变量
│   │   │   │   ├── security.py   # JWT 认证与密码处理
│   │   │   │   └── socketio.py   # Socket.IO 集成逻辑
│   │   │   ├── db/
│   │   │   │   ├── models/       # SQLModel 数据模型 (继承自 base)
│   │   │   │   ├── base.py       # SQLModel 基类
│   │   │   │   └── session.py    # 数据库会话管理
│   │   │   ├── features/         # [核心] 领域驱动的业务逻辑模块
│   │   │   │   └── todos/
│   │   │   │       ├── router.py
│   │   │   │       ├── schemas.py  # Pydantic API 数据模型
│   │   │   │       └── services.py # 业务逻辑实现
│   │   │   ├── main.py             # FastAPI 应用入口与中间件配置
│   │   │   └── worker.py           # ARQ 异步任务定义
│   │   ├── tests/                  # Pytest 测试
│   │   ├──.env.example
│   │   ├── Dockerfile
│   │   └── pyproject.toml          # 使用 uv 和 ruff
│   │
│   ├── frontend/                   # 前端应用 (Nuxt)
│   │   ├── assets/
│   │   ├── components/             # 页面级组件
│   │   ├── layouts/
│   │   ├── pages/
│   │   ├── plugins/                # Nuxt 插件
│   │   ├── public/
│   │   ├── server/                 # Nuxt 服务端 API/中间件
│   │   ├── store/                  # Pinia 状态管理
│   │   ├── tests/                  # Vitest (单元/组件) & Playwright (E2E)
│   │   ├──.env.example
│   │   ├── Dockerfile
│   │   ├── nuxt.config.ts
│   │   └── package.json
│   │
│   ├── ml-api/                     # 目标检测模型服务 (FastAPI + YOLOv8)
│   │   ├── src/
│   │   │   ├── models/             # 存放.pt 模型文件
│   │   │   ├── main.py             # 模型推理 API
│   │   │   └── utils.py            # OpenCV 图像预处理/后处理
│   │   ├──.env.example
│   │   ├── Dockerfile              # 基于 nvidia/cuda 的 Dockerfile
│   │   └── pyproject.toml
│   │
│   ├── audio-api/                  # 音频处理服务 (FastAPI + Fast-Whisper)
│   │   ├── src/
│   │   │   ├── core/
│   │   │   │   └── whisper.py      # Whisper 模型加载与推理
│   │   │   ├── main.py             # 音频转录 API
│   │   │   └── utils.py            # ffmpeg 音频格式转换
│   │   ├──.env.example
│   │   ├── Dockerfile              # 包含 ffmpeg 和 CUDA 的 Dockerfile
│   │   └── pyproject.toml
│   │
│   └── scraper/                    # 网络爬虫 (Scrapy)
│       ├── {{ cookiecutter.scraper_name }}/
│       │   ├── spiders/
│       │   ├── items.py
│       │   ├── middlewares.py
│       │   └── pipelines.py        # 数据处理管道 (如存入 PostgreSQL)
│       ├── scrapy.cfg
│       ├── Dockerfile
│       └── pyproject.toml
│
├──.gitignore
├──.pre-commit-config.yaml         # [核心] 统一管理 Python (ruff) 和 JS (prettier) 的 pre-commit 钩子
├── package.json                    # pnpm 工作区定义和根脚本
├── pnpm-workspace.yaml
├── pyproject.toml                  # 根目录的 pyproject.toml, 用于 pre-commit 等全局工具
├── tsconfig.base.json
└── turbo.json                      # [核心] 高性能任务编排器 (Monorepo 的"大脑")

## 1. 完整技术栈架构表

| 领域         | 分类          | 技术选型                             | 主要用途与职责                                 | 选择理由 / 决策点                                              | 备注 / 关键集成                              |
| :--------- | :---------- | :------------------------------- | :-------------------------------------- | :------------------------------------------------------ | :------------------------------------- |
| **前端**     | 核心框架        | `Nuxt`                           | 构建高性能、支持服务端渲染(SSR)的现代化用户界面。             | 团队熟悉 Vue 生态；提供基于文件的路由和自动导入，开发体验好。                       | 与 FastAPI 后端通过 RESTful API 进行数据交互。     |
|            | 语言          | `TypeScript`                     | 为 JavaScript 提供静态类型检查，提升代码健壮性和可维护性。     | 现代前端开发标配，能规避大量潜在错误，利于长期维护和团队协作。                         |                                        |
|            | UI 样式       | `Tailwind CSS`                   | 提供原子化的 CSS 类，用于快速、高效地构建定制化 UI。          | 开发速度快，高度可定制，避免编写大量自定义 CSS。                              | Nuxt UI 基于 Tailwind CSS 构建，集成完美。       |
|            | 组件库         | `Nuxt UI`                        | 提供一套与 Nuxt 深度集成、基于 Tailwind 的高质量 UI 组件。 | 官方出品，集成度最高，能保证项目风格统一并加速开发。                              |                                        |
|            | 状态管理        | `Pinia`                          | 为 Vue/Nuxt 应用提供中心化的、类型安全的状态管理。          | Vue 官方推荐的新一代状态库，API 简洁，对 TS 支持完美。                       |                                        |
|            | 构建工具        | `Vite`                           | 提供极速的开发服务器和优化的生产环境打包构建。                 | 现代前端开发的标准，开发体验极佳。                                       | Nuxt 3 底层默认使用 Vite。                    |
|            | 测试          | `Vitest`                         | 执行单元测试和组件测试，确保代码模块的质量。                  | 与 Vite 无缝集成，配置简单，速度快，API 与 Jest 兼容。                     |                                        |
|            | 测试          | `Playwright`                     | 执行端到端(E2E)测试，模拟真实用户操作以验证业务流程。           | 功能强大，支持多浏览器，自动等待机制稳定可靠。                                 |                                        |
| **后端**     | 开发工具        | `ruff` / `ruff format`           | 提供代码的静态检查（Linting）和格式化。                 | 基于 Rust 开发，速度极快，整合了多种工具的功能，是现代 Python 项目首选。             | 通过 `pre-commit` 在代码提交前自动执行。            |
|            | 开发工具        | `uv`                             | 管理 Python 依赖的安装、锁定和虚拟环境。                | 基于 Rust 开发，速度远超 pip 和 venv，是新一代依赖管理工具。                  |                                        |
|            | 开发工具        | `pre-commit`                     | 在 Git 提交前自动运行代码检查和格式化钩子。                | 强制执行代码规范，保证进入代码库的代码质量一致性。                               |                                        |
|            | 开发工具        | `pyproject.toml`                 | PEP 621 标准的项目元数据和工具配置文件。                | Python 官方推荐的标准化配置方式，整合所有工具配置于一处。                        |                                        |
|            | Web 框架      | `FastAPI`                        | 提供异步、高性能的 RESTful API 服务，自带数据校验和文档生成。   | 异步性能优越；基于 Pydantic 的类型提示和数据校验非常强大。                      | 通过 `starlette-prometheus` 暴露监控指标。      |
|            | Web 服务器     | `Gunicorn` + `Uvicorn`           | 在生产环境中运行和管理 FastAPI 应用进程。               | Gunicorn 是成熟的进程管理器，Uvicorn 是高性能的 ASGI 服务器，两者是生产部署的黄金搭档。 |                                        |
|            | 异步任务        | `ARQ`                            | 处理后台耗时任务（如发送邮件、数据处理），避免阻塞 API 响应。       | API 简洁，原生支持 asyncio 和 Pydantic，与 FastAPI 技术栈契合度高。       | 使用 `Redis` 作为消息代理（Broker）。             |
|            | 测试          | `pytest`                         | 编写和执行后端应用的单元测试、集成测试。                    | Python 生态中最流行、功能最强大的测试框架，插件丰富。                          |                                        |
|            | 交互式开发       | `jupyter`                        | 用于数据探索、API 调试和原型验证的交互式笔记本。              | 方便进行探索性编程和可视化。                                          |                                        |
| **数据库**    | 关系型数据库      | `PostgreSQL`                     | 作为核心业务数据的主存储。                           | 功能强大，稳定可靠，社区活跃，对 JSON 和全文搜索支持良好。                        |                                        |
|            | ORM         | `SQLModel`                       | 提供 Pythonic 的方式与数据库交互，统一数据模型与 API 模型。   | 由 FastAPI 作者开发，与 FastAPI/Pydantic 生态无缝集成。               | 操作 `PostgreSQL` 数据库。                   |
|            | 数据库迁移       | `Alembic`                        | 管理和版本化数据库的表结构变更。                        | SQLAlchemy 官方推荐的迁移工具，功能强大且灵活。                           |                                        |
|            | 缓存/内存数据库    | `Redis`                          | 提供高性能缓存，并作为 ARQ 的消息代理。                  | 性能极高，数据结构丰富，是业界缓存和消息队列的事实标准之一。                          | 通过 `fastapi-cache2` 为 API 提供缓存。        |
| **DevOps** | 容器化         | `Docker`                         | 将前后端应用及其环境打包成标准化的容器镜像。                  | 实现开发、测试、生产环境的一致性，简化部署。                                  | 镜像由 `Kubernetes` 部署和管理。                |
|            | 容器编排        | `Kubernetes (K8s)`               | 自动化部署、扩展和管理容器化的应用程序。                    | 云原生领域的事实标准，具备强大的服务发现、自愈和扩缩容能力。                          | 通过 `Helm` 管理应用部署。                      |
|            | IaC         | `OpenTofu`                       | 使用代码来定义和管理云基础设施资源。                      | Terraform 的开源分支，实现基础设施的版本控制和自动化。                        |                                        |
|            | K8s 配置管理    | `Helm`                           | 打包、分发和管理 Kubernetes 应用。                 | K8s 的包管理器，简化了复杂应用的部署和版本更新。                              |                                        |
|            | CI/CD       | `GitHub Actions`                 | 自动化代码测试、安全扫描、镜像构建和部署流程。                 | 与代码仓库无缝集成，社区生态丰富，配置简单。                                  | 在流水线中调用 `Trivy` 和 `GitHub Dependabot`。 |
|            | Ingress 控制器 | `Traefik`                        | 管理集群的南北向流量，提供路由、负载均衡和 SSL。              | 配置简单，支持自动化服务发现和证书管理。                                    | 与 `cert-manager` 集成自动申请 SSL 证书。        |
|            | 证书管理        | `cert-manager`                   | 自动化在 K8s 集群中申请、续订和使用 TLS 证书。            | 自动化 HTTPS，是保障 K8s 服务安全的必备组件。                            |                                        |
| **安全**     | 依赖扫描        | `GitHub Dependabot`              | 自动扫描项目依赖中的已知安全漏洞，并尝试创建修复 PR。            | 与 GitHub 原生集成，自动化程度高。                                   |                                        |
|            | 镜像扫描        | `Trivy`                          | 在 CI/CD 流程中扫描 Docker 镜像，发现操作系统和应用依赖的漏洞。 | 扫描速度快，漏洞库更新及时，易于集成。                                     |                                        |
|            | 密钥管理        | `HashiCorp Vault`                | 在生产环境中安全地存储、访问和管理密钥（如数据库密码、API Key）。    | 提供了统一的密钥管理方案，支持动态密钥和细粒度权限控制。                            |                                        |
|            | 本地开发密钥      | `python-dotenv`                  | 在本地开发环境中通过 `.env` 文件加载环境变量，避免密钥硬编码。     | 简单易用，是本地开发事实上的标准。                                       |                                        |
| **可观测性**   | 指标监控        | `Prometheus`                     | 采集应用和基础设施的时间序列指标数据。                     | 云原生监控的事实标准，拥有强大的查询语言和告警能力。                              |                                        |
|            | 可视化与告警      | `Grafana`                        | 将监控数据（指标、日志）进行可视化展示，并配置告警规则。            | 可视化能力强大，支持多种数据源，是 Prometheus 的黄金搭档。                     |                                        |
|            | 日志聚合        | `Loki`                           | 收集所有容器的日志，提供中心化的日志查询和分析。                | 与 Prometheus/Grafana 无缝集成，资源占用比 ELK 栈更低。                |                                        |
|            | 分布式追踪       | `OpenTelemetry` + `Jaeger`       | 追踪一个请求在多个服务间的完整调用链，用于性能分析和故障排查。         | OpenTelemetry 是标准化的数据采集规范，Jaeger 是成熟的追踪数据存储和展示系统。       |                                        |
| **云与外部服务** | 对象存储        | `Amazon S3` / `MinIO`            | 存储用户上传的文件、静态资源等非结构化数据。                  | S3 是云服务标准，MinIO 提供兼容 S3 API 的自托管方案，灵活度高。                |                                        |
|            | CDN         | `Cloudflare`                     | 提供内容分发网络，加速全球用户访问，并提供额外的安全防护。           | 性能强大，提供丰富的免费套餐功能（如 DDoS 防护，WAF）。                        |                                        |
|            | 邮件服务        | `Amazon SES`                     | 用于发送应用的事务性邮件（如注册验证、密码重置）。               | 服务稳定，成本效益高，与云生态集成好。                                     |                                        |
|            | 全文搜索        | `PostgreSQL FTS` / `Meilisearch` | 提供高级的文本搜索功能。                            | 优先使用 PG 自带功能降低架构复杂度，必要时 Meilisearch 提供更优的性能和体验。         |                                        |
|            | 后台管理        | `FastAPI-Amis-Admin`             | 为 FastAPI 应用快速生成功能强大的后台管理界面。            | 基于百度 Amis 低代码框架，定制化能力强，开发效率高。                           |                                        |
|            | 实时通信        | `Socket.IO`                      | 实现客户端与服务器之间的双向实时通信。                     | 提供了可靠的 WebSocket 连接，支持自动重连和多种回退机制。                      |                                        |

## 2. 网络爬虫技术栈

| 领域     | 分类             | 技术选型                        | 主要用途与职责                                        | 选择理由 / 决策点                                                           | 备注 / 关键集成                                            |
| ------ | -------------- | --------------------------- | ---------------------------------------------- | -------------------------------------------------------------------- | ---------------------------------------------------- |
| **爬虫** | 核心框架           | `Scrapy`                    | 提供一个完整、异步的爬虫框架，管理请求调度、数据提取(Item Pipeline)和中间件。 | Python 爬虫领域的事实标准，为构建大型、结构化的爬虫项目提供了完整的解决方案。                           |                                                      |
|        | JS 渲染 / 浏览器自动化 | `Playwright`                | 用于渲染和操作由 JavaScript 动态加载内容的网页。                 | 现代化的浏览器自动化工具，API 友好，性能优于 Selenium，社区活跃。                              | 可通过 `scrapy-playwright` 中间件与 Scrapy 无缝集成。            |
|        | 数据提取与解析        | `parsel`                    | 从 HTML/XML 文档中提取数据。                            | `parsel` 是 Scrapy 内置的库，支持 XPath/CSS 选择器，性能好；`Beautiful Soup` 解析容错性强。 |                                                      |
|        | 分布式与调度         | `Scrapy-Redis`              | 将 Redis 用作 Scrapy 的请求队列和去重集合，实现分布式爬取。          | Scrapy 生态中最成熟的分布式方案，可以轻松横向扩展爬虫集群。                                    | 使用你已有的 `Redis` 服务。                                   |
|        | 反屏蔽策略          | 代理服务 / CAPTCHA 破解           | 轮换 IP 代理以避免被封禁；对接打码平台处理验证码。                    | 规模化爬取的必备策略，保证爬虫的稳定性和成功率。                                             | 可集成 `Zyte`, `BrightData` 等商业代理服务，或 `2Captcha` 等打码平台。 |
|        | 数据存储           | `PostgreSQL` / `S3`+`MinIO` | 存储结构化的爬取数据和下载的媒体文件（图片、视频等）。                    | 直接复用你已有的数据存储设施，无需引入新技术。                                              | Scrapy 的 Item Pipeline 可以定制，将数据写入 PG，文件存入 S3。        |

---

## 3. 目标检测技术栈

| 领域       | 分类     | 技术选型                                     | 主要用途与职责                               | 选择理由 / 决策点                                                  | 备注 / 关键集成                        |
| -------- | ------ | ---------------------------------------- | ------------------------------------- | ----------------------------------------------------------- | -------------------------------- |
| **目标检测** | 深度学习框架 | `PyTorch`                                | 构建、训练和部署深度学习模型的核心框架。                  | 语法 Pythonic，动态图机制灵活，社区庞大，是当前学术界和工业界的首选。                     | `TensorFlow` 是另一个强大的备选项。         |
|          | 核心模型与库 | `Ultralytics YOLO` (v8)                  | 提供最先进的（SOTA）目标检测模型，集训练、验证、推理功能于一体。    | 在速度和精度上达到了极致的平衡，开箱即用，文档完善，是目标检测任务的理想起点。                     |                                  |
|          | 图像处理   | `OpenCV`                                 | 在模型推理前后对图像进行预处理（如缩放、归一化）和后处理（如绘制边界框）。 | 两者都是 Python 计算机视觉领域的基础库，功能强大且稳定。                            |                                  |
|          | 数据标注   | `CVAT` (Computer Vision Annotation Tool) | 用于标注自定义数据集，为训练模型准备数据。                 | 开源、功能强大，支持团队协作，可自托管部署在 Docker 或 K8s 中。                      | `LabelImg` 是更轻量级的本地标注工具。         |
|          | 实验跟踪   | `Weights & Biases (W&B)`                 | 记录和可视化模型训练过程中的各项参数、指标和产出物。            | 自动化地管理实验，便于模型对比和复现，是严肃 ML 项目的必备工具。                          |                                  |
|          | 模型服务化  | `FastAPI`                                | 将训练好的模型封装成 API 服务，供外部调用。              | `FastAPI` 轻量且高效，非常适合快速部署；`Triton` 是为大规模、高性能（GPU）推理设计的专用服务器。 | 可在你已有的 `FastAPI` 应用中开辟一个专门的推理端点。 |
|          | 硬件依赖   | `NVIDIA GPU` + `CUDA`                    | 为模型训练和推理提供必要的并行计算能力。                  | 深度学习领域的硬件基石，没有 GPU，训练和推理将非常缓慢。                              | 在 K8s 中需要配置 GPU Operator 和节点。    |

--- 
### 要求

Chocolatey 管系统软件，pipx 管 Python 工具

.gitignore使用gibo生成

系统是win11，命令优先用bash的：

具体命令行生成时要有中文注释和序号`（且注意```PowerShell里PowerShell跟随在"```后）`，
例如
```PowerShell
# 1. 安装 Chocolatey (如果尚未安装)
Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# 2. 关闭管理员 PowerShell，打开一个普通的 Git Bash 终端
```

```Bash
# 1. 安装 pipx (用于管理 Python 工具)
pip install pipx
pipx ensurepath

```

如果有github上的仓库创建过程也应该写出来

python 选择 Python 3.11.9

